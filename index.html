<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario y Excel</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <h1>Formato de Actividades Realizadas </h1>
    <form id="mi-formulario" action="https://formsubmit.co/baracaldo2@yahoo.com" method="POST">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="mensaje">Mensaje:</label><br>
        <textarea id="mensaje" name="mensaje" rows="4" cols="50" required></textarea><br><br>

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required><br><br>

        <label for="cliente">Cliente:</label>
        <input type="text" id="cliente" name="cliente" required><br><br>

        <label for="actividad">Actividad Programada:</label><br>
        <textarea id="actividad" name="actividad" rows="4" cols="50" required></textarea><br><br>

        <label for="modelo">Modelo del Equipo:</label>
        <input type="text" id="modelo" name="modelo"><br><br>

        <label for="serial">Serial del Equipo:</label>
        <input type="text" id="serial" name="serial"><br><br>

        <div class="validaciones">
            <h2>Validaciones</h2>
            <label><input type="checkbox" name="fuga" value="fuga"> Se detectó fuga</label><br>
            <label><input type="checkbox" name="hielo" value="hielo"> Falla por bloqueo de hielo</label><br>
            <label><input type="checkbox" name="aislante" value="hielo"> Daño de aislante termico de tuberias</label><br>
            <label><input type="checkbox" name="humedad" value="hielo"> Humedad en el sistema</label><br>
            <label><input type="checkbox" name="saturacion" value="hielo"> Saturación de Refrigerante</label><br>
            <label><input type="checkbox" name="expansion" value="hielo"> Valvula de Expansión descalibrada</label><br>
            <label><input type="checkbox" name="hielo" value="controlador"> Controlador desconfigurado</label><br>
            <label><input type="checkbox" name="electrico" value="electrico"> Falla de componente eléctrico</label><br>
        </div><br>

        <label for="voltaje L1 - L2">Voltaje L1 - L2:</label>
        <input type="number" id="voltaje L1 - L2" name="voltaje"><br><br>

        <label for="voltaje L2 - L3">Voltaje L2 - L3:</label>
        <input type="number" id="voltaje L2 - L3" name="voltaje"><br><br>

        <label for="voltaje L1 - L3">Voltaje L1 - L3:</label>
        <input type="number" id="voltaje L1 - L3" name="voltaje"><br><br>

        <label for="amperios L1">Amperios L1:</label>
        <input type="number" id="amperios L1" name="amperios L1"><br><br>

        <label for="amperios L2">Amperios L2:</label>
        <input type="number" id="amperios L2" name="amperios L2"><br><br>

        <label for="amperios L3">Amperios L3:</label>
        <input type="number" id="amperios L3" name="amperios L3"><br><br>

        <label for="presion LP">Presiones de Operación LP:</label>
        <input type="text" id="presion LP" name="presion LP"><br><br>

        <label for="presion HP">Presiones de Operación HP:</label>
        <input type="text" id="presion HP" name="presion HP"><br><br>

        <label for="superheat">Superheat:</label>
        <input type="number" id="superheat" name="superheat"><br><br>

        <label for="subcooling">Subcooling:</label>
        <input type="number" id="subcooling" name="subcooling"><br><br>

        <button type="submit">Enviar y Descargar CSV</button>
    </form>

    <script>
        document.getElementById('mi-formulario').addEventListener('submit', function(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const csvData = [];
            formData.forEach((value, key) => {
                csvData.push(`${key},${value}`);
            });
            const csvContent = "data:text/csv;charset=utf-8," + csvData.join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "formulario.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            form.submit();
        });
    </script>
</body>
</html>