<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario y Excel</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <h1>Formulario</h1>
    <form id="mi-formulario" action="https://formsubmit.co/baracaldo2@yahoo.com" method="POST">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="mensaje">Mensaje:</label><br>
        <textarea id="mensaje" name="mensaje" rows="4" cols="50" required></textarea><br><br>

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha" name="fecha" required><br><br>

        <label for="cliente">Cliente:</label>
        <input type="text" id="cliente" name="cliente" required><br><br>

        <label for="actividad">Actividad Programada:</label><br>
        <textarea id="actividad" name="actividad" rows="4" cols="50" required></textarea><br><br>

        <label for="modelo">Modelo del Equipo:</label>
        <input type="text" id="modelo" name="modelo"><br><br>

        <label for="serial">Serial del Equipo:</label>
        <input type="text" id="serial" name="serial"><br><br>

        <div class="validaciones">
            <h2>Validaciones</h2>
            <label><input type="checkbox" name="fuga" value="fuga"> Se detectó fuga</label><br>
            <label><input type="checkbox" name="hielo" value="hielo"> Falla por bloqueo de hielo</label><br>
            <label><input type="checkbox" name="electrico" value="electrico"> Falla de componente eléctrico</label><br>
        </div><br>

        <label for="voltaje">Voltaje:</label>
        <input type="number" id="voltaje" name="voltaje"><br><br>

        <label for="amperios">Amperios:</label>
        <input type="number" id="amperios" name="amperios"><br><br>

        <label for="presion">Presiones de Operación:</label>
        <input type="text" id="presion" name="presion"><br><br>

        <label for="superheat">Superheat:</label>
        <input type="number" id="superheat" name="superheat"><br><br>

        <label for="subcooling">Subcooling:</label>
        <input type="number" id="subcooling" name="subcooling"><br><br>

        <button type="submit">Enviar y Descargar CSV</button>
    </form>

    <script>
        document.getElementById('mi-formulario').addEventListener('submit', function(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const csvData = [];
            formData.forEach((value, key) => {
                csvData.push(`${key},${value}`);
            });
            const csvContent = "data:text/csv;charset=utf-8," + csvData.join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "formulario.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            form.submit();
        });
    </script>
</body>
</html>